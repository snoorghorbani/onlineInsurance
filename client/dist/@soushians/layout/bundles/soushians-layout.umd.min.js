!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ngrx/store"),require("@angular/core"),require("rxjs/BehaviorSubject"),require("@soushians/config"),require("@angular/animations"),require("@soushians/authentication"),require("@angular/common"),require("@angular/platform-browser"),require("rxjs/observable/fromEvent"),require("@angular/router"),require("rxjs"),require("@angular/forms"),require("@angular/common/http"),require("@angular/flex-layout"),require("@ngrx/effects"),require("@angular/material")):"function"==typeof define&&define.amd?define("@soushians/layout",["exports","@ngrx/store","@angular/core","rxjs/BehaviorSubject","@soushians/config","@angular/animations","@soushians/authentication","@angular/common","@angular/platform-browser","rxjs/observable/fromEvent","@angular/router","rxjs","@angular/forms","@angular/common/http","@angular/flex-layout","@ngrx/effects","@angular/material"],t):t((e.soushians=e.soushians||{},e.soushians.layout={}),null,e.ng.core,e.Rx,null,e.ng.animations,null,e.ng.common,e.ng.platformBrowser,e.Rx.Observable,e.ng.router,null,e.ng.forms,e.ng.common.http,e.ng["flex-layout"],null,e.ng.material)}(this,function(e,t,n,a,i,o,r,s,c,u,l,d,p,m,g,h,f){"use strict";var b="[Layout] Open Sidenav",y="[Layout] Close Sidenav",S={UPDATE_LAYOUT_CONFIG:"[Layout] UPDATE_LAYOUT_CONFIG",SIGNOUT:"[Layout] signout",TITLE_CHANGED:"[LAYOUT] TITLE_CHANGED",CHANGE_LAYOUT:"[Layout] Change Layout",CHANGE_MAIN_SIDENAVE_MODE:"[Layout] Change main sidenav mode",OPEN_SECOND_SIDEBAR:"[Layout] Open Second Sidebar",CLOSE_SECOND_SIDEBAR:"[Layout] Close Second Sidebar",CHANGE_SECOND_SIDENAV_MODE:"[Layout] Change second sidenav mode"},v=function(e){this.payload=e,this.type=S.UPDATE_LAYOUT_CONFIG},M=function(){this.type=b},x=function(){this.type=y},A=function(e){this.name=e,this.type=S.CHANGE_LAYOUT},C=function(e){this.mode=e,this.type=S.CHANGE_MAIN_SIDENAVE_MODE},O=function(e){this.mode=e,this.type=S.CHANGE_SECOND_SIDENAV_MODE},w=function(){this.type=S.SIGNOUT},E=function(e){this.title=e,this.type=S.TITLE_CHANGED},N=function(){this.type=S.OPEN_SECOND_SIDEBAR},_=function(){this.type=S.CLOSE_SECOND_SIDEBAR},L={showMainSidenav:!1,showSecondSideNav:!1,secondSideNavMode:"over",mainSideNavMode:"over",showLeftNavBar:!1,stickyLeftNavBar:!1,layoutMode:"default",title:"",menuItems:[]};var I="[Layout][TOOLBAR] COMPORTABLE",T="[Layout][TOOLBAR] COMPACT",D="[Layout][TOOLBAR] SUMMARY",j="[Layout][TOOLBAR] ENABLE_COMFORTABLE_MODE",k="[Layout][TOOLBAR] DISBALE_COMFORTABLE_MODE",B=function(){this.type=I},R=function(){this.type=T},F=function(){this.type=D},P=function(){this.type=j},U=function(){this.type=k},G={mode:"compact",enableComfortableMode:!1,comfortableModeHaveBeenDone:!1};var q={layout:function(e,t){switch(void 0===e&&(e=L),t.type){case S.UPDATE_LAYOUT_CONFIG:return Object.assign({},e,t.payload);case y:return Object.assign({},e,{showMainSidenav:!1});case b:return Object.assign({},e,{showMainSidenav:!0});case S.TITLE_CHANGED:return Object.assign({},e,{title:t.title});case S.CHANGE_LAYOUT:return Object.assign({},e,{layoutMode:t.name});case S.CHANGE_MAIN_SIDENAVE_MODE:return Object.assign({},e,{mainSideNavMode:t.mode});case S.CLOSE_SECOND_SIDEBAR:return Object.assign({},e,{showSecondSideNav:!1});case S.OPEN_SECOND_SIDEBAR:return Object.assign({},e,{showSecondSideNav:!0});case S.CHANGE_SECOND_SIDENAV_MODE:return Object.assign({},e,{secondSideNavMode:t.mode});default:return e}},toolbar:function(e,t){switch(void 0===e&&(e=G),t.type){case T:return Object.assign({},e,{mode:"compact"});case I:return Object.assign({},e,{mode:e.enableComfortableMode?"comfortable":"compact"});case D:return Object.assign({},e,{mode:"summary"});case j:return Object.assign({},e,{enableComfortableMode:!0});case k:return Object.assign({},e,{mode:"compact",enableComfortableMode:!1});default:return e}}},$=t.createFeatureSelector("layout"),H=t.createSelector($,function(e){return e.layout}),V=t.createSelector(H,function(e){return e.title}),Y=t.createSelector(H,function(e){return e.showMainSidenav}),z=t.createSelector(H,function(e){return e.mainSideNavMode}),W=t.createSelector(H,function(e){return e.layoutMode}),J=t.createSelector(H,function(e){return e.showSecondSideNav}),K=t.createSelector(H,function(e){return e.secondSideNavMode}),Q=t.createSelector($,function(e){return e.toolbar}),X=t.createSelector(Q,function(e){return e.mode}),Z={showMainSidenav:!1,showSecondSideNav:!0,secondSideNavMode:"over",mainSideNavMode:"over",showLeftNavBar:!1,stickyLeftNavBar:!1,layoutMode:"with-margin",title:"",menuItems:[{route:"/",icon:"multiline_chart",roles:["Admin","User"],title:"صفحه اصلی"},{route:"/configs",icon:"settings",roles:["Admin"],title:"تنظیمات"},{route:"/source",icon:"device_hub",roles:["Admin"],title:"آدرس سرویس ها"}]},ee=new n.InjectionToken("LayoutModuleConfig"),te=function(){function e(e,t){var o=this;this.store=t,this.config$=new a.BehaviorSubject(this._config),this._config=Object.assign({},Z,e),this.config$.next(this._config),this.store.select(i.getlayoutModuleConfig).subscribe(function(e){e&&(o.store.dispatch(new v(e.Config)),o._config=Object.assign({},o._config,e.Config),o.config$.next(o._config))})}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),e}();te.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],te.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:[ee]}]},{type:t.Store}]},te.ngInjectableDef=n.defineInjectable({factory:function(){return new te(n.inject(ee),n.inject(t.Store))},token:te,providedIn:"root"});var oe=function(e,t,o){this.store=e,this.signinService=t,this.configurationService=o,this.closeSidebar=new n.EventEmitter,this.routes=this.configurationService.config$.map(function(e){return e.menuItems})};oe.decorators=[{type:n.Component,args:[{selector:"ngs-layout-main-menu",template:'<mat-list class="main-menu-container">\n  <div *ngIf="authenticated | async">\n    <a *ngFor="let item of routes | async" (click)="closeSidebar.emit()" routerLinkActive="active" mat-list-item [routerLink]="[item.route]">\n      <mat-icon mat-list-icon>{{item.icon}}</mat-icon>\n      <span mdLine>{{item.title}}</span>\n    </a>\n  </div>\n</mat-list>',styles:[".active{background:rgba(0,0,0,.15)}.mat-list-item.active mat-icon{color:#0072ae}a.mat-list-item.child{margin-right:20px}#clearUserMenuItem{position:absolute;left:13px;top:13px}"],animations:[o.trigger("childMenu",[o.state("inactive",o.style({height:"0px",opacity:"0"})),o.state("active",o.style({height:"48px",opacity:"1"})),o.transition("inactive => active",o.animate("100ms ease-in")),o.transition("active => inactive",o.animate("100ms ease-out"))]),o.trigger("menuItem",[o.state("inactive",o.style({height:"48px"})),o.state("active",o.style({height:"100px"})),o.transition("inactive => active",o.animate("100ms ease-in")),o.transition("active => inactive",o.animate("100ms ease-out"))])]}]}],oe.ctorParameters=function(){return[{type:t.Store},{type:r.SigninService},{type:te}]},oe.propDecorators={closeSidebar:[{type:n.Output}],authenticated:[{type:n.Input}],customerMobileInput:[{type:n.ViewChild,args:["customerMobileInput"]}]};var ne=function(){function e(){}return e.prototype.ngOnInit=function(){},e}();ne.decorators=[{type:n.Component,args:[{selector:"app-search-box",template:'<div class="search-box">\n  \x3c!--<td-search-box class="search-box-container" backIcon="arrow_back" placeholder="جستجو" [showUnderline]="false" [debounce]="500" [alwaysVisible]="false"\n                 (searchDebounce)="searchInputTerm = $event" (search)="searchInputTerm = $event" (clear)="searchInputTerm = \'\'">\n  </td-search-box>--\x3e\n</div>',styles:[""]}]}],ne.ctorParameters=function(){return[]};var ae=function(e){this.sdf=e};ae.decorators=[{type:n.Component,args:[{selector:"app-logo-container",template:"<div id=\"background\"></div>\n  <img class=\"shatelLogoAnimation\" routerLink='/' src='../../../assets/images/shatel-logo.png' />\n\x3c!--<img class=\"logoTypeAnimation\" src='../../../assets/images/logo-type.png' />--\x3e",styles:[".shatelLogoAnimation{height:35px;cursor:pointer;z-index:2}#background{position:absolute;top:0;right:0;width:300px;height:70px}"]}]}],ae.ctorParameters=function(){return[{type:te}]};var ie=function(){function e(e,t,o,n){var a=this;this.document=e,this._location=t,this.store=o,this.configurationService=n,this.store.dispatch(new B),this.config$=this.store.select(Q),this.config$.subscribe(function(e){return a.config=e}),this.lastScroll=this.document.body.scrollTop,this.showSecondSidenav=this.store.select(J),this.showMainSidenav=this.store.select(Y),this.toolbarAnimationState=this.store.select(X),this.menuItems$=this.configurationService.config$.map(function(e){return e.menuItems}),u.fromEvent(this.document.body,"scroll").subscribe(function(){var e=a.document.body.scrollTop,t=e-a.lastScroll<0;if(a.lastScroll=a.document.body.scrollTop,0==e){if("comfortable"==a.config.mode)return;a.store.dispatch(new B)}else if(e<128||t){if("compact"==a.config.mode)return;a.store.dispatch(new R)}else{if("summary"==a.config.mode)return;a.store.dispatch(new F)}})}return e.prototype.onWindowScroll=function(){},e.prototype.signout=function(){this.store.dispatch(new w)},e.prototype.goback=function(){this._location.back()},e.prototype.toggleSecondSidebar=function(){var t;this.showSecondSidenav.subscribe(function(e){t=e?new _:new N}),this.store.dispatch(t)},e.prototype.toggleMainSidebar=function(){var t;this.showMainSidenav.subscribe(function(e){t=e?new x:new M}),this.store.dispatch(t)},e}();ie.decorators=[{type:n.Component,args:[{selector:"layout-toolbar",template:'<mat-toolbar [@toolbarAnimation]="toolbarAnimationState | async">\n  <mat-toolbar-row>\n    <app-logo-container fxFlex="none" fxLayoutAlign="end center"></app-logo-container>\n\n    <button type="button" *ngIf=\'showSidebarMenu\' (click)="toggleMainSidebar()" mat-icon-button fxFlex="nogrow" fxLayoutAlign="center center">\n      <mat-icon>menu</mat-icon>\n    </button>\n    <span id=\'app-name\'>\n      {{app_config?.Config.AppTitle}}\n    </span>\n    <app-title fxFlex fxLayoutAlign="start center"></app-title>\n    <app-search-box fxFlex fxLayoutAlign="end center"></app-search-box>\n    \n    <button mat-icon-button type="button" (click)="toggleSecondSidebar()" fxFlex="nogrow" fxLayoutAlign="center center">\n      <mat-icon>notifications</mat-icon>\n    </button>\n    <button *ngIf="user" mat-icon-button [matMenuTriggerFor]="toolbarMenu1">\n      <mat-icon>account_circle</mat-icon>\n    </button>\n        <mat-menu #toolbarMenu1>\n          <button routerLink=\'/user/panel\' mat-menu-item>\n            <mat-icon>fingerprint</mat-icon>\n            <span>{{user?.Username}}</span>\n          </button>\n          \n          <button (click)=\'signout()\' mat-menu-item>\n            <mat-icon>exit_to_app</mat-icon>\n            <span>خروج</span>\n          </button>\n        </mat-menu>\n    <button mat-icon-button (click)=\'goback()\'>\n      <mat-icon>arrow_back</mat-icon>\n    </button>\n    \n  </mat-toolbar-row>\n  <mat-toolbar-row>\n    <button mat-button \n    *ngFor="let menu of menuItems$ | async"\n    routerLinkActive="active"\n    [routerLink]="[menu.route]" \n    >\n    \x3c!-- <mat-icon mat-list-icon>{{menu.icon}}</mat-icon> --\x3e\n    <span>{{menu.title}}</span>\n  </button>\n</mat-toolbar-row>\n</mat-toolbar>',styles:[""],animations:[o.trigger("toolbarAnimation",[o.state("comfortable",o.style({backgroundColor:"rgba(119,181,63,1)",color:"rgba(256,256,256,1)",height:"33vh",top:"0",boxShadow:"1px 1px 3px rgba(0,0,0,0)"})),o.state("compact",o.style({backgroundColor:"rgba(256,256,256,1)",height:"128px",top:"0",boxShadow:"1px 1px 3px rgba(0,0,0,0.5)"})),o.state("summary",o.style({backgroundColor:"rgba(256,256,256,1)",height:"128px",top:"-64px",boxShadow:"1px 1px 3px rgba(0,0,0,0.5)"})),o.transition("comfortable => compact",o.animate("400ms ease-in")),o.transition("comfortable => summary",o.animate("400ms ease-in")),o.transition("summary => compact",o.animate("400ms ease-out")),o.transition("summary => comfortable",o.animate("400ms ease-out")),o.transition("compact => comfortable",o.animate("400ms ease-out")),o.transition("compact => summary",o.animate("400ms ease-in"))])]}]}],ie.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:[c.DOCUMENT]}]},{type:s.Location},{type:t.Store},{type:te}]},ie.propDecorators={showSidebarMenu:[{type:n.Input}],app_config:[{type:n.Input,args:["app-config"]}],user:[{type:n.Input}],onWindowScroll:[{type:n.HostListener,args:["body:scroll",[]]}]};var re=function(){function e(){}return e.prototype.ngOnInit=function(){},e}();re.decorators=[{type:n.Component,args:[{selector:"app-footer",template:'<div fxLayoutAlign="center center" class="footer-text">&copy; 2005-2017 همه حقوق برای شرکت شاتل محفوظ است. </div>\n',styles:[":host{position:absolute;bottom:0;left:0;right:0;border-top:1px solid #e5e5e5;padding:8px;overflow:hidden}.footer-text{position:relative;top:12px}"]}]}],re.ctorParameters=function(){return[]};var se=function(e,t){var a=this;this.store=e,this.router=t,this.mapper=[],this.title$=this.store.select(V),this.router.events.subscribe(function(o){if(o instanceof l.NavigationEnd){var n="";a.mapper.forEach(function(e){var t=e(o);return!!t&&(n=t,!0)}),a.store.dispatch(new E("/ "+n||""))}})};se.decorators=[{type:n.Component,args:[{selector:"app-title",template:'<div id="title">\n    {{title$ | async}}\n</div>',styles:["#title{margin-right:-30px;font-weight:bolder;font-size:13px;padding:18px 40px}"]}]}],se.ctorParameters=function(){return[{type:t.Store},{type:l.Router}]};var ce=function(){function e(e,t){var o=this;this.store=e,this.router=t,this.showSidebarMenu=new d.BehaviorSubject(!0),this.width=100,this.store.dispatch(new C("push")),this.user$=this.store.select(function(e){return e.user.user.data}),this.user$.subscribe(function(e){}),this.showMainSidenav=this.store.select(Y),this.mainSidenavMode=this.store.select(z),this.toolbarAnimationState=this.store.select(X),this.store.dispatch(new O("push")),this.showSecondSidenav=this.store.select(J),this.secondSidenavMode=this.store.select(K),this.layoutMode=this.store.select(W),this.router.events.filter(function(e){return e instanceof l.NavigationEnd}).subscribe(function(e){["/auth/signin"==e.urlAfterRedirects,"/auth/signup/register"==e.urlAfterRedirects,"/auth/signup/verification"==e.urlAfterRedirects,"/user/password/reset"==e.urlAfterRedirects].some(function(e){return e})?o.showSidebarMenu.next(!1):o.showSidebarMenu.next(!0)}),this.layoutMode.subscribe(function(e){o.mainSideNav&&(o.mainSideNav.nativeElement.className="",o.mainSideNav.nativeElement.classList.add(e))})}return e.prototype.onSecondSidebarClosedStart=function(){this.store.dispatch(new _)},e.prototype.onSidebarClosedStart=function(){this.store.dispatch(new x)},e}();ce.decorators=[{type:n.Component,args:[{selector:"layout-main",template:'<div #mainSideNav [className]="toolbarAnimationState | async">\n  \x3c!-- <mat-progress-bar *ngIf=\'progressStatus$ | async\' color="primary" mode="query"></mat-progress-bar> --\x3e\n  <layout-toolbar [user]="user$ | async" [showSidebarMenu]=\'showSidebarMenu | async\' [app-config]="app_config"></layout-toolbar>\n  \n  <mat-sidenav-container id="layout-sidnav">\n    <mat-sidenav [mode]="mainSidenavMode | async" [opened]=\'showMainSidenav | async\' #sidebar (closedStart)="onSidebarClosedStart()">\n      <mat-nav-list>\n        <ngs-layout-main-menu [authenticated]=\'showSidebarMenu\' (closeSidebar)="sidebar.close()" (click)="onSecondSidebarClosedStart()"></ngs-layout-main-menu>\n      </mat-nav-list>\n    </mat-sidenav>\n    \x3c!-- <mat-sidenav [mode]="secondSidenavMode | async" [opened]=\'showSecondSidenav | async\' (closedStart)="onSecondSidebarClosedStart()"\n      position="end" #second_sidebar class="second_sidebar">\n      <mat-nav-list fxLayout=\'column\'>\n      </mat-nav-list>\n    </mat-sidenav> --\x3e\n    <div fxFlexLayout=\'column\' id="app-main-container" fxLayoutAlign=\'center center\'>\n      <div fxFlex=\'0 0 100\'>\n        <router-outlet></router-outlet>\n        <footer>\n          <app-footer></app-footer>\n        </footer>\n      </div>\n    </div>\n  </mat-sidenav-container>\n</div>',styles:["#purchase-fab-button{position:fixed;bottom:23px;left:31px}md-progress-bar{position:absolute!important}.with-margin #app-main-container{margin-top:25px;padding-right:25px;padding-left:25px}.second_sidebar{width:380px}.more-detail{margin:8px;box-sizing:border-box;padding:10px;text-align:center;width:96%;border:1px solid #dedede;outline:0;cursor:pointer;transition:all .3s ease}.more-detail:hover{background:#eee}"]}]}],ce.ctorParameters=function(){return[{type:t.Store},{type:l.Router}]},ce.propDecorators={app_config:[{type:n.Input,args:["app-config"]}],mainSideNav:[{type:n.ViewChild,args:["mainSideNav"]}]};var ue=function(){function e(){}return e.forRoot=function(e){return{ngModule:le,providers:[{provide:ee,useValue:e}]}},e}();ue.decorators=[{type:n.NgModule,args:[{imports:[s.CommonModule,c.BrowserModule,l.RouterModule,p.FormsModule,m.HttpClientModule,g.FlexLayoutModule,f.MatIconModule,f.MatButtonModule,f.MatCardModule,f.MatSnackBarModule,f.MatSidenavModule,f.MatExpansionModule,f.MatSelectModule,f.MatFormFieldModule,f.MatListModule,f.MatMenuModule,f.MatRadioModule,f.MatInputModule,f.MatToolbarModule,f.MatDatepickerModule,f.MatProgressBarModule,l.RouterModule,i.NgsConfigModule],declarations:[oe,ne,ae,ie,re,se,ce],exports:[oe,ne,ae,ie,re,se,ce]}]}];var le=function(){};le.decorators=[{type:n.NgModule,args:[{imports:[ue,t.StoreModule.forFeature("layout",q),h.EffectsModule.forFeature([])],exports:[ue]}]}],e.LayoutActionTypes=S,e.TitleChangedAction=E,e.OpenSidenavAction=M,e.CloseSidenavAction=x,e.ChangeSideNavMode=C,e.ChangeLayout=A,e.CloseSecondSidenavAction=_,e.ChangeSecondSidenavMode=O,e.OpenSecondSidenavAction=N,e.ChangeToolbatToComfortableModeAction=B,e.ChangeToolbatToCompactModeAction=R,e.DisableComfortableModeAction=U,e.EnableComfortableModeAction=P,e.NgsLayoutModule=ue,e.RootNgsLayoutModule=le,e.ɵi=re,e.ɵg=ae,e.ɵa=oe,e.ɵk=ce,e.ɵf=ne,e.ɵj=se,e.ɵh=ie,e.ɵd=ee,e.ɵl=q,e.ɵc=te,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=soushians-layout.umd.min.js.map
