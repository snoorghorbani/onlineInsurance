<mat-sidenav-container>
    <!-- <mat-sidenav mode="side" #requestDetailNav *ngIf='showSidebarMenu | async' [opened]='showSidebarMenu | async'> -->
    <mat-sidenav position='end' mode="side" #requestDetailNav>
        <mat-tab-group #requestDetailTabs>
            <mat-tab label="مشخصات" *ngIf="activeRequest.Request">
                <ng-template mat-tab-label>
                    <mat-icon>accessibility</mat-icon>
                </ng-template>
                <!-- <h3 mat-subheader>مشخصات بیمه نامه درخواستی</h3> -->
                <div *ngIf="userService.is_role('Admin')">
                    مشحضات کاریر اینجا نمایش داده می شود
                </div>
                <div fxLayout='column' class='list-items'>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>سطح پوشش</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.Coveragelevel | currencyUnit}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>سابقه عدم خسارت</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.DamageHistoy}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>مدت بیمه</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.InsuranceTerm}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>سال تولید خودرو</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.CarProductionYear}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>تاریخ سررسید</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.DueDate | persianDate}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>مبلغ پرداختی</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.PaidMoney | currencyUnit}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>شرکت بیمه</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.insuranceCompany}}</p>
                    </div>
                </div>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon>account_balance</mat-icon>
                </ng-template>
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon>history</mat-icon>
                </ng-template>
                تاریخچه تمامی تاریخچه درخواست نمایش داده میشود
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon>attachment</mat-icon>
                </ng-template>
                لیست پیوست های درخواست به همراه متا دیتای پیوست نمایش داده میشود
            </mat-tab>
            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon>chat</mat-icon>
                </ng-template>
                <chat></chat>
            </mat-tab>
            <mat-tab *ngIf="activeRequest.Request">
                <ng-template mat-tab-label>
                    <mat-icon>attach_money</mat-icon>
                </ng-template>
                <div fxLayout='column' class='list-items'>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>قیمت</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.FinalPrice | currencyUnit}}</p>
                    </div>
                    <div class='list-item' fxLayout='row' fxLayoutAlign='center center'>
                        <mat-icon fxFlex='nogrow'>laptop</mat-icon>
                        <div fxFlex='15px'></div>
                        <p fxFlex='40'>کارمزد بازاریابی</p>
                        <p fxFlex='60' fxLayoutAlign="end">{{activeRequest.Request.Marketing | currencyUnit}}</p>
                    </div>
                </div>
            </mat-tab>
        </mat-tab-group>
    </mat-sidenav>

    <div fxFlexLayout='column' fxLayoutAlign='center center'>
        <div fxFlex='0 0 100'>
            <div id='con' fxFlexLayout="row">
                <div fxFlex="grow">
                    <mat-accordion>
                        <mat-expansion-panel *ngFor='let item of (data$ | async).data' (click)="openRequest(item);" (closed)="requestDetailNav.close()">
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    <span fxShow fxHide.xs="true">
                                        <mat-icon>directions_car</mat-icon>
                                        {{item.Message}}
                                    </span>
                                    <span fxShow fxHide.gt-xs="true">
                                        #{{item.Id}}
                                    </span>
                                </mat-panel-title>
                                <mat-panel-description fxShow>
                                    <span>در تاریخ {{item.Date | persianDate}}</span>
                                </mat-panel-description>
                            </mat-expansion-panel-header>

                            <div *ngIf="userService.is_role('agent')">
                                <mat-form-field>
                                    <input matInput placeholder="نام" (focus)="openRequestDetailsTab()">
                                </mat-form-field>
                                <mat-form-field>
                                    <input matInput placeholder="نام خانوادگی" (focus)="openRequestDetailsTab()">
                                </mat-form-field>
                                <mat-form-field>
                                    <input matInput placeholder="قیمت" (focus)="openMoneyTab()" [(ngModel)]='RequestFinalPrice'>
                                    <span matSuffix>ريال&nbsp;</span>
                                </mat-form-field>
                                <mat-form-field>
                                    <input matInput [matDatepicker]="picker" placeholder="تاریخ سررسید">
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker touchUi="true" #picker></mat-datepicker>
                                </mat-form-field>
                                <button mat-button color="primary">آپلود عکس بیمه نامه</button>
                            </div>
                            <div *ngIf="userService.is_role('Admin')">
                                <div>انتخاب و ارسال درخواست نماینده در این قسمت انجام میشود</div>
                            </div>
                            <mat-action-row>
                                <button *ngIf="userService.is_role('agent')" mat-button color="primary" (click)="openCommunicationTab()">تماس با درخواست دهنده</button>
                                <button mat-button color="primary" (click)="openHistoryTab()">تاریخچه</button>
                                <button mat-button color="primary" (click)="openAttachmentTab()">پیوست ها</button>
                                <button mat-button color="primary" (click)="openMoneyTab()">جزییات مالی</button>
                                <!-- <button mat-button color="warn" (click)="prevStep()"></button> -->
                                <button *ngIf="userService.is_role('agent')" mat-raised-button color="primary" (click)="submit()">ثبت بیمه نامه</button>
                                <button *ngIf="userService.is_role('Admin')" mat-raised-button color="primary" (click)="updatePolicy()">ثبت</button>
                            </mat-action-row>
                        </mat-expansion-panel>
                    </mat-accordion>
                </div>
                <!-- <div fxFlex="25px"></div>
                <mat-card fxFlex="500px">
                    <mat-card-title>
                        realtime reports
                    </mat-card-title>
                    <mat-card-content>
                        realtime reports
                    </mat-card-content>
                </mat-card> -->
            </div>

        </div>
    </div>
</mat-sidenav-container>